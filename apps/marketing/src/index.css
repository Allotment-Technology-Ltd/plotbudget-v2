/*
 * PLOT Marketing Site — Global Styles
 * ====================================
 * Theme colors aligned with @repo/design-tokens (same values).
 * The .dark class (toggled on <html> by useTheme) swaps all values.
 * Inline here so marketing deploys without pnpm workspace (Vercel).
 */

@import 'tailwindcss';
@plugin '@tailwindcss/typography';
@config '../tailwind.config.js';

/* Theme tokens — aligned with packages/design-tokens */
:root {
  --bg-primary: #F5F0EA;
  --bg-secondary: #FFFFFF;
  --bg-elevated: #F0EBE4;
  --text-primary: #111111;
  --text-secondary: #555555;
  --accent-primary: #0E8345;
  /* WCAG 2.2: accent as text on light bg needs ≥4.5:1; #0A5C30 on cream passes */
  --accent-text: #0A5C30;
  --accent-glow: rgba(14, 131, 69, 0.15);
  --border-subtle: rgba(0, 0, 0, 0.08);
  --border-accent: rgba(14, 131, 69, 0.3);
  --surface-overlay: rgba(0, 0, 0, 0.03);
}

.dark {
  --bg-primary: #111111;
  --bg-secondary: #1A1A1A;
  --bg-elevated: #222222;
  --text-primary: #F5F0EA;
  --text-secondary: #999999;
  --accent-primary: #69F0AE;
  --accent-text: var(--accent-primary);
  --accent-glow: rgba(105, 240, 174, 0.12);
  --border-subtle: rgba(255, 255, 255, 0.08);
  --border-accent: rgba(105, 240, 174, 0.2);
  --surface-overlay: rgba(255, 255, 255, 0.03);
}

/* ========================================================
   2. BASE RESETS & DEFAULTS
   ======================================================== */

@layer base {
  html {
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  body {
    @apply bg-plot-bg text-plot-text font-body;
    transition: background-color 0.3s ease, color 0.3s ease;
  }

  /* Default focus ring — green accent, visible for keyboard users */
  *:focus-visible {
    outline: 2px solid var(--accent-primary);
    outline-offset: 2px;
  }

  /* Remove default focus ring for mouse users */
  *:focus:not(:focus-visible) {
    outline: none;
  }

  ::selection {
    background-color: var(--accent-primary);
    color: #ffffff;
  }

  .dark ::selection {
    color: #111111;
  }
}

/* ========================================================
   3. CUSTOM COMPONENT CLASSES
   ======================================================== */

@layer components {
  /* Prose: ensure bold/strong use body text colour (typography plugin can override otherwise) */
  .prose strong,
  .prose b {
    color: var(--text-primary) !important;
  }

  /* Terminal-style section label (e.g., "THE PROBLEM") — WCAG 2.2 compliant accent text */
  .section-label {
    @apply font-heading text-label uppercase tracking-[0.15em] text-plot-accent-text;
  }

  /* Section headline */
  .section-headline {
    @apply font-heading text-headline-sm md:text-headline uppercase text-plot-text;
  }

  /* Terminal prompt prefix for cards */
  .terminal-prompt::before {
    content: '>_ ';
    @apply text-plot-accent-text;
  }

  /* Card base style */
  .card {
    @apply bg-plot-surface border border-plot-border p-8;
    border-radius: 0;
  }

  /* CTA button base — WCAG 2.2: text on accent bg ≥4.5:1 (light: white on green; dark: dark on mint) */
  .btn-primary {
    @apply inline-flex items-center justify-center
           bg-plot-accent px-6 py-3
           font-heading text-cta-sm md:text-cta uppercase
           tracking-[0.2em]
           transition-all duration-200;
    color: #ffffff;
    border-radius: 0;
  }

  .dark .btn-primary {
    color: #111111;
  }

  .btn-primary:hover {
    box-shadow: 0 0 20px var(--accent-glow);
    transform: translateY(-1px);
  }

  .btn-primary:active {
    transform: translateY(0);
  }

  /* Text on accent background (badges, etc.) — same contrast rule as .btn-primary */
  .text-on-accent {
    color: #ffffff;
  }

  .dark .text-on-accent {
    color: #111111;
  }

  /* Ghost/outline button variant */
  .btn-ghost {
    @apply inline-flex items-center justify-center
           border border-plot-border-accent px-6 py-3
           font-heading text-cta-sm md:text-cta uppercase
           tracking-[0.2em] text-plot-accent-text
           transition-all duration-200;
    background: transparent;
    border-radius: 0;
  }

  .btn-ghost:hover {
    background: var(--accent-glow);
  }
}

/* ========================================================
   4. UTILITY CLASSES
   ======================================================== */

@layer utilities {
  /* Max-width content wrapper */
  .content-wrapper {
    @apply w-full max-w-content mx-auto px-6 md:px-10 xl:px-20;
  }

  /* Section vertical spacing */
  .section-padding {
    @apply py-16 md:py-20 xl:py-24;
  }

  /* Section divider — visible line between hero and content / between content sections */
  .section-divider {
    @apply border-t-2 border-plot-border;
  }

  /*
   * Content page container — same max width as Roadmap timeline (max-w-4xl) for consistent
   * content constraint across all pages. Use for Blog, Changelog, and other long-form content.
   */
  .content-page {
    @apply w-full max-w-4xl mx-auto px-6 py-12 md:py-16 pb-24;
  }

  /*
   * Page header section — same max width as Roadmap (max-w-4xl). Same top padding as .content-page
   * so hero starts at the same distance from the navbar on every page.
   */
  .page-header-section {
    @apply w-full max-w-4xl mx-auto px-6 md:px-10 xl:px-20 pt-12 md:pt-16 pb-16 md:pb-20 xl:pb-24;
  }

  /* Terminal cursor blink */
  .cursor-blink {
    display: inline-block;
    width: 0.6em;
    height: 1.1em;
    background-color: var(--accent-primary);
    animation: blink 1s step-end infinite;
    vertical-align: text-bottom;
    margin-left: 2px;
  }

  /* Glow text effect */
  .text-glow {
    text-shadow: 0 0 20px var(--accent-glow);
  }
}

/* ========================================================
   5. SCANLINE OVERLAY (Dark mode only)
   Very subtle CRT effect for the terminal aesthetic.
   Completely invisible in light mode.
   ======================================================== */

.dark body::after {
  content: '';
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0.015) 0px,
    rgba(0, 0, 0, 0.015) 1px,
    transparent 1px,
    transparent 3px
  );
  pointer-events: none;
  z-index: 9998;
}

/* ========================================================
   6. CUSTOM SCROLLBAR
   ======================================================== */

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-primary);
}

::-webkit-scrollbar-thumb {
  background: var(--border-subtle);
  border-radius: 0;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--accent-primary);
}

/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border-subtle) var(--bg-primary);
}

/* ========================================================
   7. REDUCED MOTION
   Respect user preference — disable all animations
   ======================================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ========================================================
   8. PHONE MOCKUP FRAME
   CSS-only device frame for the App Showcase section
   ======================================================== */

.phone-frame {
  position: relative;
  width: 260px;
  background: #000;
  border-radius: 28px;
  padding: 8px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

.phone-frame::before {
  /* Dynamic Island */
  content: '';
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 22px;
  background: #000;
  border-radius: 12px;
  z-index: 3;
}

.phone-screen {
  width: 100%;
  border-radius: 20px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.phone-screen::before {
  /* Safe area spacer — pushes content below the dynamic island */
  content: '';
  display: block;
  width: 100%;
  height: 44px;
  flex-shrink: 0;
}

.phone-screen-dark::before {
  background: #1a1d1f;
}

.phone-screen-light::before {
  background: #f5f0ea;
}

.phone-screen img,
.phone-screen video {
  width: 100%;
  height: auto;
  display: block;
  object-fit: cover;
}

/* Short frame for screenshots: fixed height, crop from bottom (e.g. hide Financial health / How the blueprint works) */
.phone-screen--short img {
  height: 400px;
  object-fit: cover;
  object-position: top center;
}

.phone-screen-video {
  min-height: 512px;
  object-position: top center;
}

@media (min-width: 810px) {
  .phone-frame {
    width: 280px;
  }

  .phone-screen::before {
    height: 48px;
  }
}

/* ========================================================
   9. DESKTOP & TABLET MOCKUP FRAMES
   For "Phone, tablet, desktop" showcase on homepage
   ======================================================== */

.device-frame-desktop {
  background: var(--plot-surface);
  border: 1px solid var(--plot-border);
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
  overflow: hidden;
  border-radius: 0;
}

.device-frame-desktop__chrome {
  height: 32px;
  padding: 0 12px;
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--plot-elevated);
  border-bottom: 1px solid var(--plot-border);
}

.device-frame-desktop__chrome-dots {
  display: flex;
  gap: 6px;
}

.device-frame-desktop__chrome-dots span {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--plot-muted);
}

.device-frame-desktop__chrome-dots span:nth-child(1) { background: #ed6a5e; }
.device-frame-desktop__chrome-dots span:nth-child(2) { background: #f5bf4f; }
.device-frame-desktop__chrome-dots span:nth-child(3) { background: #62c554; }

.device-frame-desktop__chrome-url {
  flex: 1;
  max-width: 280px;
  margin: 0 auto;
  padding: 4px 12px;
  font-size: 11px;
  font-family: var(--font-mono);
  color: var(--plot-muted);
  background: var(--plot-bg);
  border: 1px solid var(--plot-border);
  text-align: center;
}

/* Desktop: content area has fixed aspect (16:10) so the frame never stretches the image */
.device-frame-desktop__content {
  position: relative;
  width: 100%;
  aspect-ratio: 16 / 10;
  overflow: hidden;
  background: var(--plot-bg);
}

.device-frame-desktop__img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  object-position: top center;
  display: block;
}

.device-frame-tablet {
  background: #000;
  padding: 10px;
  border-radius: 16px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

/* Tablet: screen has fixed aspect (4:3) so the frame never stretches the image */
.device-frame-tablet__screen {
  position: relative;
  width: 100%;
  aspect-ratio: 4 / 3;
  border-radius: 8px;
  overflow: hidden;
  background: #000;
}

.device-frame-tablet__img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
  object-position: top center;
  display: block;
}
