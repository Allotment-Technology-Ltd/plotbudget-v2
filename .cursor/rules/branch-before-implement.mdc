---
description: Always create a new branch before implementing changes; push to branch and open PR, not main
alwaysApply: true
---

# Branch Before Implementing Changes

When an agent is engaged to **implement a change** (new feature, fix, refactor, or any code change that will be committed):

0. **Linear ticket (audit trail) — before creating a branch or writing code:** Prompt the user to confirm there is a Linear ticket for this change. Ask for the issue ID (e.g. PROJ-123) if they have one, so the branch can be named for autolink. If they do not have a ticket, suggest creating one in Linear (or via Cursor: command palette → "Linear: Create Issue") and wait for the ID, or for explicit confirmation to proceed without one. Do not create a branch or start implementing until the user has responded.

1. **Create a new branch** after step 0 is resolved.
   - Use a short, descriptive name: `feat/partner-invite`, `fix/type-errors`, `docs/readme`.
   - **Linear:** If the user is working from a Linear ticket (e.g. PROJ-123, app-101), use branch format `<issue-id>-<short-slug>` (e.g. `PROJ-123-update-login`) so Linear ↔ GitHub autolink works. Prefer the exact ID the user gave.
   - Create from the current branch (usually `main`): `git checkout -b <branch-name>`.

2. **Make all changes on that branch**; do not commit or push to `main`.

3. **When the user asks to commit or push:**
   - Commit on the new branch.
   - Push the branch: `git push origin <branch-name>`.
   - Suggest opening a PR to `main` (or `develop`) so CI runs and Vercel creates a preview. Do not push directly to `main` unless the user explicitly asks to.

4. **If the user says "push to main" or "merge to main":** Confirm they want to push/merge to main, since the preferred flow is branch → PR → merge.

**Exclusions:** One-off exploratory edits, answering questions without changing code, or when the user explicitly says "no branch", "commit to main", or "no Linear" / "skip Linear ticket" — follow the user's instruction. If the user has already provided a Linear issue ID in the same request, skip the prompt and use that ID for the branch name.
